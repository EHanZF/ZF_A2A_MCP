version: "1.0.0"

server:
  id: "zf-a2a-mcp"
  name: "ZF A2A MCP Tool Bus"
  description: "Deterministic MCP tool bus for multi-agent alignment."
  runtime:
    language: "python"
    command: "python"
    args:
      - "-m"
      - "zf_a2a_mcp.server"
  repository:
    type: "github"
    url: "https://github.com/EHanZF/ZF_A2A_MCP.git"
    branch: "main"

capabilities:
  tool_vector:
    get_status: 1
    run_local_task: 1
    query_public_dataset: 1
    generate_report: 1

tools:
  - name: "get_status"
    description: "Return health, version, and uptime info for the tool bus."
    input_schema:
      type: object
      additionalProperties: false
      properties:
        verbose:
          type: boolean
          description: "Include extended diagnostics."
      required: []
    output_schema:
      type: object
      additionalProperties: false
      properties:
        status:
          type: string
          enum: ["ok", "degraded", "error"]
        version:
          type: string
        uptime_seconds:
          type: number
        details:
          type: object
          additionalProperties: true
      required: ["status", "version", "uptime_seconds"]

  - name: "run_local_task"
    description: "Execute a deterministic task."
    input_schema:
      type: object
      additionalProperties: false
      properties:
        task_id:
          type: string
        parameters:
          type: object
          additionalProperties: true
      required: ["task_id"]
    output_schema:
      type: object
      additionalProperties: false
      properties:
        task_id:
          type: string
        status:
          type: string
          enum: ["queued", "running", "completed", "failed"]
        result:
          type: ["object", "null"]
          additionalProperties: true
        error:
          type: ["string", "null"]
      required: ["task_id", "status"]

  - name: "query_public_dataset"
    description: "Query a deterministic snapshot of a public dataset."
    input_schema:
      type: object
      additionalProperties: false
      properties:
        dataset_name:
          type: string
        query:
          type: string
        limit:
          type: integer
          minimum: 1
          maximum: 1000
          default: 100
      required: ["dataset_name", "query"]
    output_schema:
      type: object
      additionalProperties: false
      properties:
        dataset_name:
          type: string
        rows:
          type: array
          items:
            type: object
            additionalProperties: true
        truncated:
          type: boolean
      required: ["dataset_name", "rows", "truncated"]

  - name: "generate_report"
    description: "Generate a deterministic report using tool bus data."
    input_schema:
      type: object
      additionalProperties: false
      properties:
        report_type:
          type: string
          enum: ["status_summary", "dataset_overview", "task_history"]
        format:
          type: string
          enum: ["markdown", "text"]
          default: "markdown"
        parameters:
          type: object
          additionalProperties: true
      required: ["report_type"]
    output_schema:
      type: object
      additionalProperties: false
      properties:
        report_type:
          type: string
        format:
          type: string
        content:
          type: string
      required: ["report_type", "format", "content"]

resources:
  - name: "server_docs"
    type: "file"
    description: "Documentation for the ZF A2A tool bus."
    uri: "./docs/server-overview.md"

  - name: "datasets_index"
    type: "file"
    description: "Available dataset snapshot index."
    uri: "./data/datasets_index.json"

prompts:
  - name: "status_check"
    description: "Prompt for tool bus status requests."
    input_schema:
      type: object
      additionalProperties: false
      properties:
        verbosity:
          type: string
          enum: ["short", "detailed"]
          default: "short"
      required: []
    template: |
      Querying the ZF A2A Tool Bus.
      Verbosity: {{ verbosity }}

  - name: "dataset_inspection"
    description: "Prompt for dataset review."
    input_schema:
      type: object
      additionalProperties: false
      properties:
        dataset_name:
          type: string
        question:
          type: string
      required: ["dataset_name", "question"]
    template: |
      Analyze dataset "{{ dataset_name }}" to answer:
      "{{ question }}"

a2a:
  agents:
    - id: "agent_a"
      role: "consumer"
      allowed_tools:
        - get_status
        - run_local_task
        - query_public_dataset
        - generate_report

    - id: "agent_b"
      role: "consumer"
      allowed_tools:
        - get_status
        - run_local_task
        - query_public_dataset
        - generate_report

  canonical_tool_vector:
    get_status: 1
    run_local_task: 1
    query_public_dataset: 1
    generate_report: 1

stubs:
  python:
    package_name: "zf_a2a_mcp_client"
    entrypoint: "client.py"
  typescript:
    package_name: "@zf/a2a-mcp-client"
    entrypoint: "src/client.ts"
